{"ast":null,"code":"var _jsxFileName = \"E:\\\\KTCity\\\\react-course-project\\\\react-monkey-blogging\\\\src\\\\module\\\\category\\\\CategoryUpdate.js\",\n    _s = $RefreshSig$();\n\nimport { Button } from \"components/button\";\nimport { Radio } from \"components/checkbox\";\nimport { Field } from \"components/field\";\nimport { Input } from \"components/input\";\nimport { Label } from \"components/label\";\nimport { useAuth } from \"contexts/auth-context\";\nimport { db } from \"firebase-app/firebase-config\";\nimport { doc, getDoc, updateDoc } from \"firebase/firestore\";\nimport DashboardHeading from \"module/dashboard/DashboardHeading\";\nimport React, { useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\nimport { toast } from \"react-toastify\";\nimport slugify from \"slugify\";\nimport Swal from \"sweetalert2\";\nimport { categoryStatus, userRole } from \"utils/constants\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst CategoryUpdate = () => {\n  _s();\n\n  const {\n    control,\n    reset,\n    watch,\n    handleSubmit,\n    formState: {\n      isSubmitting\n    }\n  } = useForm({\n    mode: \"onChange\",\n    defaultValues: {}\n  });\n  const [params] = useSearchParams();\n  const categoryId = params.get(\"id\");\n  const navigate = useNavigate();\n  useEffect(() => {\n    async function fetchData() {\n      const colRef = doc(db, \"categories\", categoryId);\n      const singleDoc = await getDoc(colRef);\n      reset(singleDoc.data());\n    }\n\n    fetchData();\n  }, [categoryId, reset]);\n  const watchStatus = watch(\"status\");\n  const {\n    userInfo\n  } = useAuth();\n\n  const handleUpdateCategory = async values => {\n    if ((userInfo === null || userInfo === void 0 ? void 0 : userInfo.role) !== userRole.ADMIN) {\n      Swal.fire(\"Failed\", \"You have no right to do this action\", \"warning\");\n      return;\n    }\n\n    const colRef = doc(db, \"categories\", categoryId);\n    await updateDoc(colRef, {\n      name: values.name,\n      slug: slugify(values.slug || values.name, {\n        lower: true\n      }),\n      status: Number(values.status)\n    });\n    toast.success(\"Update category successfully!\");\n    navigate(\"/manage/category\");\n  };\n\n  if (!categoryId) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(DashboardHeading, {\n      title: \"Update category\",\n      desc: `Update your category id: ${categoryId}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit(handleUpdateCategory),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-layout\",\n        children: [/*#__PURE__*/_jsxDEV(Field, {\n          children: [/*#__PURE__*/_jsxDEV(Label, {\n            children: \"Name\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            control: control,\n            name: \"name\",\n            placeholder: \"Enter your category name\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Field, {\n          children: [/*#__PURE__*/_jsxDEV(Label, {\n            children: \"Slug\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            control: control,\n            name: \"slug\",\n            placeholder: \"Enter your slug\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-layout\",\n        children: /*#__PURE__*/_jsxDEV(Field, {\n          children: [/*#__PURE__*/_jsxDEV(Label, {\n            children: \"Status\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-wrap gap-x-5\",\n            children: [/*#__PURE__*/_jsxDEV(Radio, {\n              name: \"status\",\n              control: control,\n              checked: Number(watchStatus) === categoryStatus.APPROVED,\n              value: categoryStatus.APPROVED,\n              children: \"Approved\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Radio, {\n              name: \"status\",\n              control: control,\n              checked: Number(watchStatus) === categoryStatus.UNAPPROVED,\n              value: categoryStatus.UNAPPROVED,\n              children: \"Unapproved\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 95,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        kind: \"primary\",\n        className: \"mx-auto w-[200px]\",\n        type: \"submit\",\n        disabled: isSubmitting,\n        isLoading: isSubmitting,\n        children: \"Update category\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n};\n\n_s(CategoryUpdate, \"JSQxt2fZ8KSfwimmDZP/RYyaHWo=\", false, function () {\n  return [useForm, useSearchParams, useNavigate, useAuth];\n});\n\n_c = CategoryUpdate;\nexport default CategoryUpdate;\n\nvar _c;\n\n$RefreshReg$(_c, \"CategoryUpdate\");","map":{"version":3,"sources":["E:/KTCity/react-course-project/react-monkey-blogging/src/module/category/CategoryUpdate.js"],"names":["Button","Radio","Field","Input","Label","useAuth","db","doc","getDoc","updateDoc","DashboardHeading","React","useEffect","useForm","useNavigate","useSearchParams","toast","slugify","Swal","categoryStatus","userRole","CategoryUpdate","control","reset","watch","handleSubmit","formState","isSubmitting","mode","defaultValues","params","categoryId","get","navigate","fetchData","colRef","singleDoc","data","watchStatus","userInfo","handleUpdateCategory","values","role","ADMIN","fire","name","slug","lower","status","Number","success","APPROVED","UNAPPROVED"],"mappings":"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","sourcesContent":["import { Button } from \"components/button\";\r\nimport { Radio } from \"components/checkbox\";\r\nimport { Field } from \"components/field\";\r\nimport { Input } from \"components/input\";\r\nimport { Label } from \"components/label\";\r\nimport { useAuth } from \"contexts/auth-context\";\r\nimport { db } from \"firebase-app/firebase-config\";\r\nimport { doc, getDoc, updateDoc } from \"firebase/firestore\";\r\nimport DashboardHeading from \"module/dashboard/DashboardHeading\";\r\nimport React, { useEffect } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\r\nimport { toast } from \"react-toastify\";\r\nimport slugify from \"slugify\";\r\nimport Swal from \"sweetalert2\";\r\nimport { categoryStatus, userRole } from \"utils/constants\";\r\n\r\nconst CategoryUpdate = () => {\r\n  const {\r\n    control,\r\n    reset,\r\n    watch,\r\n    handleSubmit,\r\n    formState: { isSubmitting },\r\n  } = useForm({\r\n    mode: \"onChange\",\r\n    defaultValues: {},\r\n  });\r\n  const [params] = useSearchParams();\r\n  const categoryId = params.get(\"id\");\r\n  const navigate = useNavigate();\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      const colRef = doc(db, \"categories\", categoryId);\r\n      const singleDoc = await getDoc(colRef);\r\n      reset(singleDoc.data());\r\n    }\r\n    fetchData();\r\n  }, [categoryId, reset]);\r\n  const watchStatus = watch(\"status\");\r\n  const { userInfo } = useAuth();\r\n\r\n  const handleUpdateCategory = async (values) => {\r\n    if (userInfo?.role !== userRole.ADMIN) {\r\n      Swal.fire(\"Failed\", \"You have no right to do this action\", \"warning\");\r\n      return;\r\n    }\r\n    const colRef = doc(db, \"categories\", categoryId);\r\n    await updateDoc(colRef, {\r\n      name: values.name,\r\n      slug: slugify(values.slug || values.name, { lower: true }),\r\n      status: Number(values.status),\r\n    });\r\n    toast.success(\"Update category successfully!\");\r\n    navigate(\"/manage/category\");\r\n  };\r\n  if (!categoryId) return null;\r\n  return (\r\n    <div>\r\n      <DashboardHeading\r\n        title=\"Update category\"\r\n        desc={`Update your category id: ${categoryId}`}\r\n      ></DashboardHeading>\r\n      <form onSubmit={handleSubmit(handleUpdateCategory)}>\r\n        <div className=\"form-layout\">\r\n          <Field>\r\n            <Label>Name</Label>\r\n            <Input\r\n              control={control}\r\n              name=\"name\"\r\n              placeholder=\"Enter your category name\"\r\n            ></Input>\r\n          </Field>\r\n          <Field>\r\n            <Label>Slug</Label>\r\n            <Input\r\n              control={control}\r\n              name=\"slug\"\r\n              placeholder=\"Enter your slug\"\r\n            ></Input>\r\n          </Field>\r\n        </div>\r\n        <div className=\"form-layout\">\r\n          <Field>\r\n            <Label>Status</Label>\r\n            <div className=\"flex flex-wrap gap-x-5\">\r\n              <Radio\r\n                name=\"status\"\r\n                control={control}\r\n                checked={Number(watchStatus) === categoryStatus.APPROVED}\r\n                value={categoryStatus.APPROVED}\r\n              >\r\n                Approved\r\n              </Radio>\r\n              <Radio\r\n                name=\"status\"\r\n                control={control}\r\n                checked={Number(watchStatus) === categoryStatus.UNAPPROVED}\r\n                value={categoryStatus.UNAPPROVED}\r\n              >\r\n                Unapproved\r\n              </Radio>\r\n            </div>\r\n          </Field>\r\n        </div>\r\n        <Button\r\n          kind=\"primary\"\r\n          className=\"mx-auto w-[200px]\"\r\n          type=\"submit\"\r\n          disabled={isSubmitting}\r\n          isLoading={isSubmitting}\r\n        >\r\n          Update category\r\n        </Button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CategoryUpdate;\r\n"]},"metadata":{},"sourceType":"module"}