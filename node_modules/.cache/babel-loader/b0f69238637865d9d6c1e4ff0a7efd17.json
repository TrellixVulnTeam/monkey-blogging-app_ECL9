{"ast":null,"code":"var _jsxFileName = \"E:\\\\KTCity\\\\react-course-project\\\\react-monkey-blogging\\\\src\\\\module\\\\post\\\\PostManage.js\",\n    _s = $RefreshSig$();\n\nimport { ActionDelete, ActionEdit, ActionView } from \"components/action\";\nimport { Button } from \"components/button\";\nimport { Dropdown } from \"components/dropdown\";\nimport { LabelStatus } from \"components/label\";\nimport { Table } from \"components/table\";\nimport { db } from \"firebase-app/firebase-config\";\nimport { collection, deleteDoc, doc, getDoc, getDocs, limit, onSnapshot, query, where } from \"firebase/firestore\";\nimport DashboardHeading from \"module/dashboard/DashboardHeading\";\nimport React, { useState } from \"react\";\nimport { useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport Swal from \"sweetalert2\";\nimport { postStatus } from \"utils/constants\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst POST_PER_PAGE = 10;\n\nconst PostManage = () => {\n  _s();\n\n  const [postList, setPostList] = useState([]);\n  const [filter, setFilter] = useState(\"\");\n  const [lastDoc, setLastDoc] = useState();\n  const navigate = useNavigate();\n  useEffect(() => {\n    async function fetchData() {\n      const colRef = collection(db, \"posts\");\n      const newRef = filter ? query(colRef, where(\"title\", \">=\", filter), where(\"title\", \"<=\", filter + \"utf8\")) : query(colRef, limit(POST_PER_PAGE));\n      const documentSnapshots = await getDocs(newRef);\n      const lastVisible = documentSnapshots.docs[documentSnapshots.docs.length - 1];\n      onSnapshot(newRef, snapshot => {\n        let results = [];\n        snapshot.forEach(doc => {\n          results.push({\n            id: doc.id,\n            ...doc.data()\n          });\n        });\n        setPostList(results);\n      });\n      setLastDoc(lastVisible);\n    }\n\n    fetchData();\n  }, [filter]);\n\n  const handleDeletePost = async postId => {\n    const docRef = doc(db, \"posts\", postId);\n    Swal.fire({\n      title: \"Are you sure?\",\n      text: \"You won't be able to revert this!\",\n      icon: \"warning\",\n      showCancelButton: true,\n      confirmButtonColor: \"#3085d6\",\n      cancelButtonColor: \"#d33\",\n      confirmButtonText: \"Yes, delete it!\"\n    }).then(async result => {\n      if (result.isConfirmed) {\n        await deleteDoc(docRef);\n        Swal.fire(\"Deleted!\", \"Your post has been deleted.\", \"success\");\n      }\n    });\n  };\n\n  const renderPostStatus = status => {\n    switch (status) {\n      case postStatus.APPROVED:\n        return /*#__PURE__*/_jsxDEV(LabelStatus, {\n          type: \"success\",\n          children: \"Approve\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 16\n        }, this);\n\n      case postStatus.PENDING:\n        return /*#__PURE__*/_jsxDEV(LabelStatus, {\n          type: \"warning\",\n          children: \"Pending\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 16\n        }, this);\n\n      case postStatus.REJECTED:\n        return /*#__PURE__*/_jsxDEV(LabelStatus, {\n          type: \"danger\",\n          children: \"Rejected\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 16\n        }, this);\n\n      default:\n        break;\n    }\n  };\n\n  const handleSearchPost = e => {};\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(DashboardHeading, {\n      title: \"All posts\",\n      desc: \"Manage all posts\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-10 flex justify-end gap-5\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full max-w-[200px]\",\n        children: /*#__PURE__*/_jsxDEV(Dropdown, {\n          children: /*#__PURE__*/_jsxDEV(Dropdown.Select, {\n            placeholder: \"Category\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full max-w-[300px]\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          className: \"w-full p-4 rounded-lg border border-solid border-gray-300\",\n          placeholder: \"Search post...\",\n          onChange: handleSearchPost\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Table, {\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Id\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Post\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Category\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Author\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Status\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Actions\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: postList.length > 0 && postList.map(post => {\n          var _post$createdAt, _post$createdAt2, _post$createdAt3, _post$id, _post$category, _post$user;\n\n          const date = post !== null && post !== void 0 && (_post$createdAt = post.createdAt) !== null && _post$createdAt !== void 0 && _post$createdAt.seconds ? new Date((post === null || post === void 0 ? void 0 : (_post$createdAt2 = post.createdAt) === null || _post$createdAt2 === void 0 ? void 0 : _post$createdAt2.seconds) * 1000) : new Date();\n          const formatDate = new Date(date).toLocaleDateString(\"vi-VI\");\n          console.log(new Date((post === null || post === void 0 ? void 0 : (_post$createdAt3 = post.createdAt) === null || _post$createdAt3 === void 0 ? void 0 : _post$createdAt3.seonds) * 1000));\n          return /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: ((_post$id = post.id) === null || _post$id === void 0 ? void 0 : _post$id.slice(0, 5)) + \"...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-x-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: post.image,\n                  alt: \"\",\n                  className: \"w-[66px] h-[55px] rounded object-cover\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 133,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex-1\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    className: \"font-semibold max-w-[300px] whitespace-pre-wrap\",\n                    children: post.title\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 139,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"time\", {\n                    className: \"text-sm text-gray-500\",\n                    children: [\"Date: \", formatDate]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 142,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 138,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 132,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 131,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-500\",\n                children: (_post$category = post.category) === null || _post$category === void 0 ? void 0 : _post$category.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 148,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-500\",\n                children: (_post$user = post.user) === null || _post$user === void 0 ? void 0 : _post$user.username\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: renderPostStatus(post.status)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-x-3 text-gray-500\",\n                children: [/*#__PURE__*/_jsxDEV(ActionView, {\n                  onClick: () => navigate(`/${post.slug}`)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 157,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(ActionEdit, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 160,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(ActionDelete, {\n                  onClick: () => handleDeletePost(post.id)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 161,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 156,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 155,\n              columnNumber: 19\n            }, this)]\n          }, post.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-10 text-center\",\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        className: \"mx-auto w-[200px]\",\n        children: \"See more+\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n};\n\n_s(PostManage, \"pRpGSIQ0vXnC8dEchLRLhydOSRQ=\", false, function () {\n  return [useNavigate];\n});\n\n_c = PostManage;\nexport default PostManage;\n\nvar _c;\n\n$RefreshReg$(_c, \"PostManage\");","map":{"version":3,"sources":["E:/KTCity/react-course-project/react-monkey-blogging/src/module/post/PostManage.js"],"names":["ActionDelete","ActionEdit","ActionView","Button","Dropdown","LabelStatus","Table","db","collection","deleteDoc","doc","getDoc","getDocs","limit","onSnapshot","query","where","DashboardHeading","React","useState","useEffect","useNavigate","Swal","postStatus","POST_PER_PAGE","PostManage","postList","setPostList","filter","setFilter","lastDoc","setLastDoc","navigate","fetchData","colRef","newRef","documentSnapshots","lastVisible","docs","length","snapshot","results","forEach","push","id","data","handleDeletePost","postId","docRef","fire","title","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","then","result","isConfirmed","renderPostStatus","status","APPROVED","PENDING","REJECTED","handleSearchPost","e","map","post","date","createdAt","seconds","Date","formatDate","toLocaleDateString","console","log","seonds","slice","image","category","name","user","username","slug"],"mappings":";;;AAAA,SAASA,YAAT,EAAuBC,UAAvB,EAAmCC,UAAnC,QAAqD,mBAArD;AACA,SAASC,MAAT,QAAuB,mBAAvB;AACA,SAASC,QAAT,QAAyB,qBAAzB;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,SAASC,KAAT,QAAsB,kBAAtB;AACA,SAASC,EAAT,QAAmB,8BAAnB;AACA,SACEC,UADF,EAEEC,SAFF,EAGEC,GAHF,EAIEC,MAJF,EAKEC,OALF,EAMEC,KANF,EAOEC,UAPF,EAQEC,KARF,EASEC,KATF,QAUO,oBAVP;AAWA,OAAOC,gBAAP,MAA6B,mCAA7B;AACA,OAAOC,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,SAASC,SAAT,QAA0B,OAA1B;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,OAAOC,IAAP,MAAiB,aAAjB;AACA,SAASC,UAAT,QAA2B,iBAA3B;;AACA,MAAMC,aAAa,GAAG,EAAtB;;AACA,MAAMC,UAAU,GAAG,MAAM;AAAA;;AACvB,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BR,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAACS,MAAD,EAASC,SAAT,IAAsBV,QAAQ,CAAC,EAAD,CAApC;AACA,QAAM,CAACW,OAAD,EAAUC,UAAV,IAAwBZ,QAAQ,EAAtC;AACA,QAAMa,QAAQ,GAAGX,WAAW,EAA5B;AACAD,EAAAA,SAAS,CAAC,MAAM;AACd,mBAAea,SAAf,GAA2B;AACzB,YAAMC,MAAM,GAAG1B,UAAU,CAACD,EAAD,EAAK,OAAL,CAAzB;AACA,YAAM4B,MAAM,GAAGP,MAAM,GACjBb,KAAK,CACHmB,MADG,EAEHlB,KAAK,CAAC,OAAD,EAAU,IAAV,EAAgBY,MAAhB,CAFF,EAGHZ,KAAK,CAAC,OAAD,EAAU,IAAV,EAAgBY,MAAM,GAAG,MAAzB,CAHF,CADY,GAMjBb,KAAK,CAACmB,MAAD,EAASrB,KAAK,CAACW,aAAD,CAAd,CANT;AAOA,YAAMY,iBAAiB,GAAG,MAAMxB,OAAO,CAACuB,MAAD,CAAvC;AACA,YAAME,WAAW,GACfD,iBAAiB,CAACE,IAAlB,CAAuBF,iBAAiB,CAACE,IAAlB,CAAuBC,MAAvB,GAAgC,CAAvD,CADF;AAGAzB,MAAAA,UAAU,CAACqB,MAAD,EAAUK,QAAD,IAAc;AAC/B,YAAIC,OAAO,GAAG,EAAd;AACAD,QAAAA,QAAQ,CAACE,OAAT,CAAkBhC,GAAD,IAAS;AACxB+B,UAAAA,OAAO,CAACE,IAAR,CAAa;AACXC,YAAAA,EAAE,EAAElC,GAAG,CAACkC,EADG;AAEX,eAAGlC,GAAG,CAACmC,IAAJ;AAFQ,WAAb;AAID,SALD;AAMAlB,QAAAA,WAAW,CAACc,OAAD,CAAX;AACD,OATS,CAAV;AAUAV,MAAAA,UAAU,CAACM,WAAD,CAAV;AACD;;AACDJ,IAAAA,SAAS;AACV,GA3BQ,EA2BN,CAACL,MAAD,CA3BM,CAAT;;AA4BA,QAAMkB,gBAAgB,GAAG,MAAOC,MAAP,IAAkB;AACzC,UAAMC,MAAM,GAAGtC,GAAG,CAACH,EAAD,EAAK,OAAL,EAAcwC,MAAd,CAAlB;AACAzB,IAAAA,IAAI,CAAC2B,IAAL,CAAU;AACRC,MAAAA,KAAK,EAAE,eADC;AAERC,MAAAA,IAAI,EAAE,mCAFE;AAGRC,MAAAA,IAAI,EAAE,SAHE;AAIRC,MAAAA,gBAAgB,EAAE,IAJV;AAKRC,MAAAA,kBAAkB,EAAE,SALZ;AAMRC,MAAAA,iBAAiB,EAAE,MANX;AAORC,MAAAA,iBAAiB,EAAE;AAPX,KAAV,EAQGC,IARH,CAQQ,MAAOC,MAAP,IAAkB;AACxB,UAAIA,MAAM,CAACC,WAAX,EAAwB;AACtB,cAAMlD,SAAS,CAACuC,MAAD,CAAf;AACA1B,QAAAA,IAAI,CAAC2B,IAAL,CAAU,UAAV,EAAsB,6BAAtB,EAAqD,SAArD;AACD;AACF,KAbD;AAcD,GAhBD;;AAiBA,QAAMW,gBAAgB,GAAIC,MAAD,IAAY;AACnC,YAAQA,MAAR;AACE,WAAKtC,UAAU,CAACuC,QAAhB;AACE,4BAAO,QAAC,WAAD;AAAa,UAAA,IAAI,EAAC,SAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAP;;AACF,WAAKvC,UAAU,CAACwC,OAAhB;AACE,4BAAO,QAAC,WAAD;AAAa,UAAA,IAAI,EAAC,SAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAP;;AACF,WAAKxC,UAAU,CAACyC,QAAhB;AACE,4BAAO,QAAC,WAAD;AAAa,UAAA,IAAI,EAAC,QAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAP;;AACF;AACE;AARJ;AAUD,GAXD;;AAYA,QAAMC,gBAAgB,GAAIC,CAAD,IAAO,CAAE,CAAlC;;AACA,sBACE;AAAA,4BACE,QAAC,gBAAD;AACE,MAAA,KAAK,EAAC,WADR;AAEE,MAAA,IAAI,EAAC;AAFP;AAAA;AAAA;AAAA;AAAA,YADF,eAKE;AAAK,MAAA,SAAS,EAAC,8BAAf;AAAA,8BACE;AAAK,QAAA,SAAS,EAAC,sBAAf;AAAA,+BACE,QAAC,QAAD;AAAA,iCACE,QAAC,QAAD,CAAU,MAAV;AAAiB,YAAA,WAAW,EAAC;AAA7B;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cADF,eAME;AAAK,QAAA,SAAS,EAAC,sBAAf;AAAA,+BACE;AACE,UAAA,IAAI,EAAC,MADP;AAEE,UAAA,SAAS,EAAC,2DAFZ;AAGE,UAAA,WAAW,EAAC,gBAHd;AAIE,UAAA,QAAQ,EAAED;AAJZ;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cANF;AAAA;AAAA;AAAA;AAAA;AAAA,YALF,eAoBE,QAAC,KAAD;AAAA,8BACE;AAAA,+BACE;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF,eAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHF,eAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJF,eAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBALF,eAME;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBANF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cADF,eAWE;AAAA,kBACGvC,QAAQ,CAACa,MAAT,GAAkB,CAAlB,IACCb,QAAQ,CAACyC,GAAT,CAAcC,IAAD,IAAU;AAAA;;AACrB,gBAAMC,IAAI,GAAGD,IAAI,SAAJ,IAAAA,IAAI,WAAJ,uBAAAA,IAAI,CAAEE,SAAN,4DAAiBC,OAAjB,GACT,IAAIC,IAAJ,CAAS,CAAAJ,IAAI,SAAJ,IAAAA,IAAI,WAAJ,gCAAAA,IAAI,CAAEE,SAAN,sEAAiBC,OAAjB,IAA2B,IAApC,CADS,GAET,IAAIC,IAAJ,EAFJ;AAGA,gBAAMC,UAAU,GAAG,IAAID,IAAJ,CAASH,IAAT,EAAeK,kBAAf,CAAkC,OAAlC,CAAnB;AACAC,UAAAA,OAAO,CAACC,GAAR,CAAY,IAAIJ,IAAJ,CAAS,CAAAJ,IAAI,SAAJ,IAAAA,IAAI,WAAJ,gCAAAA,IAAI,CAAEE,SAAN,sEAAiBO,MAAjB,IAA0B,IAAnC,CAAZ;AACA,8BACE;AAAA,oCACE;AAAA,wBAAK,aAAAT,IAAI,CAACxB,EAAL,sDAASkC,KAAT,CAAe,CAAf,EAAkB,CAAlB,KAAuB;AAA5B;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE;AAAA,qCACE;AAAK,gBAAA,SAAS,EAAC,2BAAf;AAAA,wCACE;AACE,kBAAA,GAAG,EAAEV,IAAI,CAACW,KADZ;AAEE,kBAAA,GAAG,EAAC,EAFN;AAGE,kBAAA,SAAS,EAAC;AAHZ;AAAA;AAAA;AAAA;AAAA,wBADF,eAME;AAAK,kBAAA,SAAS,EAAC,QAAf;AAAA,0CACE;AAAI,oBAAA,SAAS,EAAC,iDAAd;AAAA,8BACGX,IAAI,CAAClB;AADR;AAAA;AAAA;AAAA;AAAA,0BADF,eAIE;AAAM,oBAAA,SAAS,EAAC,uBAAhB;AAAA,yCACSuB,UADT;AAAA;AAAA;AAAA;AAAA;AAAA,0BAJF;AAAA;AAAA;AAAA;AAAA;AAAA,wBANF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBAFF,eAmBE;AAAA,qCACE;AAAM,gBAAA,SAAS,EAAC,eAAhB;AAAA,4CAAiCL,IAAI,CAACY,QAAtC,mDAAiC,eAAeC;AAAhD;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBAnBF,eAsBE;AAAA,qCACE;AAAM,gBAAA,SAAS,EAAC,eAAhB;AAAA,wCAAiCb,IAAI,CAACc,IAAtC,+CAAiC,WAAWC;AAA5C;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBAtBF,eAyBE;AAAA,wBAAKvB,gBAAgB,CAACQ,IAAI,CAACP,MAAN;AAArB;AAAA;AAAA;AAAA;AAAA,oBAzBF,eA0BE;AAAA,qCACE;AAAK,gBAAA,SAAS,EAAC,yCAAf;AAAA,wCACE,QAAC,UAAD;AACE,kBAAA,OAAO,EAAE,MAAM7B,QAAQ,CAAE,IAAGoC,IAAI,CAACgB,IAAK,EAAf;AADzB;AAAA;AAAA;AAAA;AAAA,wBADF,eAIE,QAAC,UAAD;AAAA;AAAA;AAAA;AAAA,wBAJF,eAKE,QAAC,YAAD;AACE,kBAAA,OAAO,EAAE,MAAMtC,gBAAgB,CAACsB,IAAI,CAACxB,EAAN;AADjC;AAAA;AAAA;AAAA;AAAA,wBALF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBA1BF;AAAA,aAASwB,IAAI,CAACxB,EAAd;AAAA;AAAA;AAAA;AAAA,kBADF;AAwCD,SA9CD;AAFJ;AAAA;AAAA;AAAA;AAAA,cAXF;AAAA;AAAA;AAAA;AAAA;AAAA,YApBF,eAkFE;AAAK,MAAA,SAAS,EAAC,mBAAf;AAAA,6BACE,QAAC,MAAD;AAAQ,QAAA,SAAS,EAAC,mBAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAlFF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAwFD,CAvJD;;GAAMnB,U;UAIaJ,W;;;KAJbI,U;AAyJN,eAAeA,UAAf","sourcesContent":["import { ActionDelete, ActionEdit, ActionView } from \"components/action\";\nimport { Button } from \"components/button\";\nimport { Dropdown } from \"components/dropdown\";\nimport { LabelStatus } from \"components/label\";\nimport { Table } from \"components/table\";\nimport { db } from \"firebase-app/firebase-config\";\nimport {\n  collection,\n  deleteDoc,\n  doc,\n  getDoc,\n  getDocs,\n  limit,\n  onSnapshot,\n  query,\n  where,\n} from \"firebase/firestore\";\nimport DashboardHeading from \"module/dashboard/DashboardHeading\";\nimport React, { useState } from \"react\";\nimport { useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport Swal from \"sweetalert2\";\nimport { postStatus } from \"utils/constants\";\nconst POST_PER_PAGE = 10;\nconst PostManage = () => {\n  const [postList, setPostList] = useState([]);\n  const [filter, setFilter] = useState(\"\");\n  const [lastDoc, setLastDoc] = useState();\n  const navigate = useNavigate();\n  useEffect(() => {\n    async function fetchData() {\n      const colRef = collection(db, \"posts\");\n      const newRef = filter\n        ? query(\n            colRef,\n            where(\"title\", \">=\", filter),\n            where(\"title\", \"<=\", filter + \"utf8\")\n          )\n        : query(colRef, limit(POST_PER_PAGE));\n      const documentSnapshots = await getDocs(newRef);\n      const lastVisible =\n        documentSnapshots.docs[documentSnapshots.docs.length - 1];\n\n      onSnapshot(newRef, (snapshot) => {\n        let results = [];\n        snapshot.forEach((doc) => {\n          results.push({\n            id: doc.id,\n            ...doc.data(),\n          });\n        });\n        setPostList(results);\n      });\n      setLastDoc(lastVisible);\n    }\n    fetchData();\n  }, [filter]);\n  const handleDeletePost = async (postId) => {\n    const docRef = doc(db, \"posts\", postId);\n    Swal.fire({\n      title: \"Are you sure?\",\n      text: \"You won't be able to revert this!\",\n      icon: \"warning\",\n      showCancelButton: true,\n      confirmButtonColor: \"#3085d6\",\n      cancelButtonColor: \"#d33\",\n      confirmButtonText: \"Yes, delete it!\",\n    }).then(async (result) => {\n      if (result.isConfirmed) {\n        await deleteDoc(docRef);\n        Swal.fire(\"Deleted!\", \"Your post has been deleted.\", \"success\");\n      }\n    });\n  };\n  const renderPostStatus = (status) => {\n    switch (status) {\n      case postStatus.APPROVED:\n        return <LabelStatus type=\"success\">Approve</LabelStatus>;\n      case postStatus.PENDING:\n        return <LabelStatus type=\"warning\">Pending</LabelStatus>;\n      case postStatus.REJECTED:\n        return <LabelStatus type=\"danger\">Rejected</LabelStatus>;\n      default:\n        break;\n    }\n  };\n  const handleSearchPost = (e) => {};\n  return (\n    <div>\n      <DashboardHeading\n        title=\"All posts\"\n        desc=\"Manage all posts\"\n      ></DashboardHeading>\n      <div className=\"mb-10 flex justify-end gap-5\">\n        <div className=\"w-full max-w-[200px]\">\n          <Dropdown>\n            <Dropdown.Select placeholder=\"Category\"></Dropdown.Select>\n          </Dropdown>\n        </div>\n        <div className=\"w-full max-w-[300px]\">\n          <input\n            type=\"text\"\n            className=\"w-full p-4 rounded-lg border border-solid border-gray-300\"\n            placeholder=\"Search post...\"\n            onChange={handleSearchPost}\n          />\n        </div>\n      </div>\n      <Table>\n        <thead>\n          <tr>\n            <th>Id</th>\n            <th>Post</th>\n            <th>Category</th>\n            <th>Author</th>\n            <th>Status</th>\n            <th>Actions</th>\n          </tr>\n        </thead>\n        <tbody>\n          {postList.length > 0 &&\n            postList.map((post) => {\n              const date = post?.createdAt?.seconds\n                ? new Date(post?.createdAt?.seconds * 1000)\n                : new Date();\n              const formatDate = new Date(date).toLocaleDateString(\"vi-VI\");\n              console.log(new Date(post?.createdAt?.seonds * 1000));\n              return (\n                <tr key={post.id}>\n                  <td>{post.id?.slice(0, 5) + \"...\"}</td>\n                  <td>\n                    <div className=\"flex items-center gap-x-3\">\n                      <img\n                        src={post.image}\n                        alt=\"\"\n                        className=\"w-[66px] h-[55px] rounded object-cover\"\n                      />\n                      <div className=\"flex-1\">\n                        <h3 className=\"font-semibold max-w-[300px] whitespace-pre-wrap\">\n                          {post.title}\n                        </h3>\n                        <time className=\"text-sm text-gray-500\">\n                          Date: {formatDate}\n                        </time>\n                      </div>\n                    </div>\n                  </td>\n                  <td>\n                    <span className=\"text-gray-500\">{post.category?.name}</span>\n                  </td>\n                  <td>\n                    <span className=\"text-gray-500\">{post.user?.username}</span>\n                  </td>\n                  <td>{renderPostStatus(post.status)}</td>\n                  <td>\n                    <div className=\"flex items-center gap-x-3 text-gray-500\">\n                      <ActionView\n                        onClick={() => navigate(`/${post.slug}`)}\n                      ></ActionView>\n                      <ActionEdit></ActionEdit>\n                      <ActionDelete\n                        onClick={() => handleDeletePost(post.id)}\n                      ></ActionDelete>\n                    </div>\n                  </td>\n                </tr>\n              );\n            })}\n        </tbody>\n      </Table>\n      <div className=\"mt-10 text-center\">\n        <Button className=\"mx-auto w-[200px]\">See more+</Button>\n      </div>\n    </div>\n  );\n};\n\nexport default PostManage;\n"]},"metadata":{},"sourceType":"module"}